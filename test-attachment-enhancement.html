<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é™„ä»¶å‘é€åŠŸèƒ½å¢å¼ºæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success {
            border-color: #28a745;
            background-color: #d4edda;
        }
        .error {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }
    </style>
</head>
<body>
    <h1>ğŸ“ é™„ä»¶å‘é€åŠŸèƒ½å¢å¼ºæµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>åŠŸèƒ½è¯´æ˜</h2>
        <p>æœ¬æ¬¡å¢å¼ºä¸ºé™„ä»¶å‘é€å¼¹çª—æ·»åŠ äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
        <ul>
            <li>âœ… åœ¨å‘é€é™„ä»¶æ—¶æ·»åŠ æŒ‡å¯¼æ–‡æœ¬ï¼š"è¯·æŒ‰ç…§çº¿ä¸ŠèŠå¤©ç§èŠï¼ˆç¾¤èŠï¼‰æ¶ˆæ¯ä¸­çš„è¦æ±‚å’Œæ ¼å¼ç”Ÿæˆè§’è‰²å›å¤ï¼Œå›å¤éœ€è¦ç¬¦åˆè§’è‰²äººè®¾å’Œå½“å‰å‰§æƒ…"</li>
            <li>âœ… æ–°å¢é™„åŠ æ¶ˆæ¯è¾“å…¥æ¡†ï¼Œç”¨æˆ·å¯ä»¥è¾“å…¥é¢å¤–çš„æ–‡æœ¬æ¶ˆæ¯</li>
            <li>âœ… æ”¯æŒæ¢è¡Œåˆ†å‰²ï¼Œæ¯è¡Œä½œä¸ºå•ç‹¬çš„æ¶ˆæ¯å‘é€</li>
            <li>âœ… ä½¿ç”¨æ­£ç¡®çš„æ¶ˆæ¯æ ¼å¼ï¼š[æˆ‘æ–¹æ¶ˆæ¯|å¥½å‹å|å¥½å‹ID|æ–‡å­—|ç”¨æˆ·è¾“å…¥å†…å®¹]</li>
            <li>âœ… ä¿æŒåŸæœ‰é™„ä»¶å‘é€é€»è¾‘ä¸å˜</li>
        </ul>
    </div>

    <div class="test-container">
        <h2>æµ‹è¯•æ¶ˆæ¯æ„å»ºé€»è¾‘</h2>
        <p>è¾“å…¥æµ‹è¯•æ•°æ®æ¥éªŒè¯æ¶ˆæ¯æ„å»ºé€»è¾‘ï¼š</p>
        
        <div style="margin-bottom: 15px;">
            <label>å¥½å‹åç§°ï¼š</label>
            <input type="text" id="friendName" value="ç§¦å€¦" style="margin-left: 10px; padding: 5px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>å¥½å‹IDï¼š</label>
            <input type="text" id="friendId" value="500002" style="margin-left: 10px; padding: 5px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>æ˜¯å¦ç¾¤èŠï¼š</label>
            <input type="checkbox" id="isGroup" style="margin-left: 10px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>é™„ä»¶æ–‡ä»¶åï¼š</label>
            <input type="text" id="fileName" value="IMG_1160(20250821-022207).PNG" style="margin-left: 10px; padding: 5px; width: 300px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>é™„åŠ æ¶ˆæ¯å†…å®¹ï¼š</label>
            <textarea id="additionalMessages" placeholder="è¾“å…¥é™„åŠ æ¶ˆæ¯å†…å®¹ï¼Œæ”¯æŒå¤šè¡Œ...">è¿™æ˜¯ç¬¬ä¸€æ¡æ¶ˆæ¯
è¿™æ˜¯ç¬¬äºŒæ¡æ¶ˆæ¯
è¿™æ˜¯ç¬¬ä¸‰æ¡æ¶ˆæ¯</textarea>
        </div>
        
        <button onclick="testMessageBuilding()">ğŸ§ª æµ‹è¯•æ¶ˆæ¯æ„å»º</button>
        
        <div id="testResult" class="test-result" style="display: none;"></div>
    </div>

    <div class="test-container">
        <h2>é¢„æœŸè¾“å‡ºç¤ºä¾‹</h2>
        <div class="test-result">
å‘ç§¦å€¦ï¼ˆ500002ï¼‰å‘é€æ¶ˆæ¯

è¯·æŒ‰ç…§çº¿ä¸ŠèŠå¤©ç§èŠæ¶ˆæ¯ä¸­çš„è¦æ±‚å’Œæ ¼å¼ç”Ÿæˆè§’è‰²å›å¤ï¼Œå›å¤éœ€è¦ç¬¦åˆè§’è‰²äººè®¾å’Œå½“å‰å‰§æƒ…

[æˆ‘æ–¹æ¶ˆæ¯|ç§¦å€¦|500002|æ–‡å­—|è¿™æ˜¯ç¬¬ä¸€æ¡æ¶ˆæ¯]
[æˆ‘æ–¹æ¶ˆæ¯|ç§¦å€¦|500002|æ–‡å­—|è¿™æ˜¯ç¬¬äºŒæ¡æ¶ˆæ¯]
[æˆ‘æ–¹æ¶ˆæ¯|ç§¦å€¦|500002|æ–‡å­—|è¿™æ˜¯ç¬¬ä¸‰æ¡æ¶ˆæ¯]

[æˆ‘æ–¹æ¶ˆæ¯|ç§¦å€¦|500002|é™„ä»¶|å›¾ç‰‡: IMG_1160(20250821-022207).PNG]
        </div>
    </div>

    <script>
        function testMessageBuilding() {
            const friendName = document.getElementById('friendName').value;
            const friendId = document.getElementById('friendId').value;
            const isGroup = document.getElementById('isGroup').checked;
            const fileName = document.getElementById('fileName').value;
            const additionalMessages = document.getElementById('additionalMessages').value;
            
            // æ¨¡æ‹Ÿattachment-senderçš„æ¶ˆæ¯æ„å»ºé€»è¾‘
            let messageContent = '';
            
            if (isGroup) {
                messageContent = `å‘${friendName}ï¼ˆ${friendId}ï¼‰å‘é€ç¾¤èŠæ¶ˆæ¯\n\n`;
                messageContent += `è¯·æŒ‰ç…§çº¿ä¸ŠèŠå¤©ç¾¤èŠæ¶ˆæ¯ä¸­çš„è¦æ±‚å’Œæ ¼å¼ç”Ÿæˆè§’è‰²å›å¤ï¼Œå›å¤éœ€è¦ç¬¦åˆè§’è‰²äººè®¾å’Œå½“å‰å‰§æƒ…\n\n`;
            } else {
                messageContent = `å‘${friendName}ï¼ˆ${friendId}ï¼‰å‘é€æ¶ˆæ¯\n\n`;
                messageContent += `è¯·æŒ‰ç…§çº¿ä¸ŠèŠå¤©ç§èŠæ¶ˆæ¯ä¸­çš„è¦æ±‚å’Œæ ¼å¼ç”Ÿæˆè§’è‰²å›å¤ï¼Œå›å¤éœ€è¦ç¬¦åˆè§’è‰²äººè®¾å’Œå½“å‰å‰§æƒ…\n\n`;
            }
            
            // å¤„ç†é™„åŠ æ¶ˆæ¯
            if (additionalMessages && additionalMessages.trim()) {
                const messageLines = additionalMessages.split('\n').filter(line => line.trim());
                
                for (const line of messageLines) {
                    const trimmedLine = line.trim();
                    if (trimmedLine) {
                        messageContent += `[æˆ‘æ–¹æ¶ˆæ¯|${friendName}|${friendId}|æ–‡å­—|${trimmedLine}]\n`;
                    }
                }
                messageContent += '\n';
            }
            
            // æ·»åŠ é™„ä»¶ä¿¡æ¯
            const isImage = fileName.toLowerCase().match(/\.(jpg|jpeg|png|gif|webp|bmp)$/);
            if (isImage) {
                messageContent += `[æˆ‘æ–¹æ¶ˆæ¯|${friendName}|${friendId}|é™„ä»¶|å›¾ç‰‡: ${fileName}]`;
            } else {
                messageContent += `[æˆ‘æ–¹æ¶ˆæ¯|${friendName}|${friendId}|é™„ä»¶|é™„ä»¶: ${fileName}]`;
            }
            
            // æ˜¾ç¤ºç»“æœ
            const resultDiv = document.getElementById('testResult');
            resultDiv.textContent = messageContent;
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            
            console.log('æ„å»ºçš„æ¶ˆæ¯å†…å®¹:', messageContent);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œä¸€æ¬¡æµ‹è¯•
        window.onload = function() {
            testMessageBuilding();
        };
    </script>
</body>
</html>
